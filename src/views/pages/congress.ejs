<section class="mb-3">
  <h1 class="h3 mb-1">Congressional Directory</h1>
  <div class="text-muted">
    Leaflet map + state selector. Data file coverage: <strong><%= officialsCount %></strong> states loaded.
  </div>
</section>

<div class="row g-3">
  <div class="col-12 col-lg-7">
    <div class="card">
      <div class="card-body">
        <div id="map" class="leaflet-map"></div>
        <div class="small text-muted mt-2">
          Click a state marker to load officials. This is a stub until you run the import script.
        </div>
      </div>
    </div>
  </div>

  <div class="col-12 col-lg-5">
    <div class="card">
      <div class="card-body">
        <div class="d-flex flex-wrap justify-content-between align-items-center gap-2">
          <h2 class="h5 mb-0">Officials</h2>
          <select id="stateSelect" class="form-select form-select-sm" style="max-width: 220px;">
            <option value="">Choose a state…</option>
            <% states.forEach((s) => { %>
              <option value="<%= s.abbr %>"><%= s.abbr %> — <%= s.name %></option>
            <% }) %>
          </select>
        </div>

        <div id="officialsList" class="mt-3">
          <div class="text-muted small">
            Select a state to view the directory entries.
          </div>
        </div>
      </div>
    </div>

    <div class="card mt-3">
      <div class="card-body">
        <h2 class="h6">Populate the full directory</h2>
        <ol class="small text-muted mb-0">
          <li>Run <code>node scripts/import-officials.mjs</code> on your machine.</li>
          <li>It will write <code>src/data/officials.json</code>.</li>
          <li>Restart the server.</li>
        </ol>
      </div>
    </div>
  </div>
</div>

<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
  crossorigin=""
/>
<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
  crossorigin=""
></script>
<script>
  window.P2DC_STATES = <%- JSON.stringify(states) %>;
</script>
<script src="/js/congress-map.js"></script>
