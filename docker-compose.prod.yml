version: "3.8"

services:
  web:
    build:
      context: .
      dockerfile: Dockerfile

    restart: unless-stopped

    expose:
      - "3000"

    environment:
      NODE_ENV: "production"
      PORT: "3000"
      DB_PATH: "/app/data/app.sqlite"
      TRUST_PROXY: "true"

      # Set these in Dokploy Variables (recommended)
      # BASE_URL: "https://your-domain.com"
      # SESSION_SECRET: "..."
      # ADMIN_PASSWORD_HASH_HEX: "..."
      # ADMIN_PASSWORD_SALT_HEX: "..."

    volumes:
      - p2dc_data:/app/data

volumes:
  p2dc_data: {}
